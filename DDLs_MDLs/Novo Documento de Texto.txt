FUNCIONARIO > 
PROJETO > 
TRABALHA_EM > 
DEPARTAMENTO > 
FILIAL

FUNCIONARIO (CPF(M),CPFSUP(S)) 
TRABALHA_EM(CPFFUNC(M)) 
PROJETO(CODIGO(M))
DEPARTAMENTO(SIGLA(M),CODFILIAL(S),CPFGERENTE(S))
FILIAL(CODIGO(M)) 

SELECT A.CPF, A.NOME, C.NOME, B.HORAS
FROM FUNCIONARIO A, TRABALHA_EM B, PROJETO C
WHERE 
	B.HORAS > 50 AND 
	A.SEXO = "M" AND 
	B.CPFFUNC = A.CPF AND 
	C.LOCAL = "BH" AND 
	B.CODPROJ = C.CODIGO
	
SELECT A.CPF, A.NOME, B.CPF, B.NOME
FROM FUNCIONARIO A, FUNCIONARIO B, DEPARTAMENTO C, FILIAL D
WHERE 
	A.CPF = B.CPFSUP AND 
	A.DEPTO = C.SIGLA AND 
	B.DEPTO = C.SIGLA AND 
	C.CPFGERENTE = B.CPF AND 
	C.LOCAL = "BH" AND 
	B.SEXO = "F" AND 
	C.CODFILIAL = D.CODIGO AND 
	D.LOCAL = "BH"
	
--------------------------------------------------------------------------
Otimização Descendente

SELECT A.CPF, A.NOME, C.NOME, B.HORAS
FROM FUNCIONARIO A, TRABALHA_EM B, PROJETO C
WHERE	
	B.CODPROJ = C.CODIGO AND
	C.LOCAL = "BH" AND 
	A.CPF = B.CPFFUNC AND
	B.HORAS > 50 AND 
	A.SEXO = "M" 
	
SELECT A.CPF, A.NOME, B.CPF, B.NOME
FROM FUNCIONARIO A, FUNCIONARIO B, DEPARTAMENTO C, FILIAL D
WHERE 
	A.DEPTO = C.SIGLA AND 	
	A.CPF = B.CPFSUP AND 
	C.CPFGERENTE = B.CPF AND 	
	B.DEPTO = C.SIGLA AND 	
	B.SEXO = "F" AND 
	C.CODFILIAL = D.CODIGO AND 
	C.LOCAL = "BH" AND
	D.LOCAL = "BH"